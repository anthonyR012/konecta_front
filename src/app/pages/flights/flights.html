<main class="main-content">
    <header class="main-header">
        <h1>Vuelos</h1>
    </header>
    @if(loading()){
    <div class="overlay">
        <div class="spinner"></div>
    </div>
    }

    <section class="filters">
        <label>
            <p>Origen</p>
            <input type="text" [value]="origin()" (input)="origin.set($any($event.target).value)">
        </label>
        <label>
            <p>Destino</p>
            <input type="text" [value]="destination()" (input)="destination.set($any($event.target).value)">
        </label>
        <label>
            <p>Fecha</p>
            <input type="date" [value]="date()" (input)="date.set($any($event.target).value)">
        </label>
    </section>

    <section class="data-table">
        @if(!loading() && flights().length){
        <table>
            <thead>
                <tr>
                    <th>Código</th>
                    <th>Origen</th>
                    <th>Destino</th>
                    <th>Salida</th>
                    <th>Disp.</th>
                    <th>Precio</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @for (f of flights(); track $index) {
                <tr>
                    <td>{{ f.code }}</td>
                    <td>{{ f.origin }}</td>
                    <td>{{ f.destination }}</td>
                    <td>{{ f.departure_at | date:'short' }}</td>
                    <td>{{ f.seats_available }}</td>
                    <td>{{ f.price | currency:'USD':'symbol' }}</td>
                    <td><button (click)="reserve(f)" [disabled]="f.seats_available < 1">Reservar</button></td>
                </tr>
                }

            </tbody>
        </table>
        }
    </section>
    @if(!loading() && total() > 0){
    <div class="pager">
        <button (click)="goPrev()" [disabled]="page() <= 1">« Anterior</button>
        <span>Página {{ page() }} de {{ lastPage() }} ({{ total() }} resultados)</span>
        <button (click)="goNext()" [disabled]="page() >= lastPage()">Siguiente »</button>
    </div>
    }

</main>