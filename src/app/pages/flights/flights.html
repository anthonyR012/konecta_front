@if(loading()){
<div class="spinner-container">
    <app-spinner></app-spinner>
</div>
}
<main class="main-content">
    <header class="main-header">
        <h1 i18n="@@flights" >Vuelos</h1>
    </header>
    @if(flights().length == 0 && !loading()){
    <app-retry [message]="message() ?? 'Sin información'" (click)="load()"></app-retry>
    }

    <section class="filters">
        <label>
            <p i18n="@@origin" >Origen</p>
            <input type="text" [value]="origin()" (input)="origin.set($any($event.target).value)">
        </label>
        <label>
            <p i18n="@@destination" >Destino</p>
            <input type="text" [value]="destination()" (input)="destination.set($any($event.target).value)">
        </label>
        <label>
            <p i18n="@@date" >Fecha</p>
            <input type="date" [value]="date()" (input)="date.set($any($event.target).value)">
        </label>
    </section>

    <section class="data-table">
        @if(!loading() && flights().length){
        <table>
            <thead>
                <tr>
                    <th i18n="@@icon" >Icono</th>
                    <th i18n="@@code" >Código</th>
                    <th i18n="@@origin" >Origen</th>
                    <th i18n="@@destination" >Destino</th>
                    <th i18n="@@departure" >Salida</th>
                    <th i18n="@@available" >Disp.</th>
                    <th i18n="@@price" >Precio</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @for (f of flights(); track $index) {
                <tr>
                    <td><img src="{{ f.icon }}" alt="Avion"></td>
                    <td>{{ f.code }}</td>
                    <td>{{ f.origin }}</td>
                    <td>{{ f.destination }}</td>
                    <td>{{ f.departure_at | date:'short' }}</td>
                    <td>{{ f.seats_available }}</td>
                    <td>{{ f.price | currency:'USD':'symbol' }}</td>
                    <td><button (click)="reserve(f)" [disabled]="f.seats_available < 1" i18n="@@reserve" >Reservar</button></td>
                </tr>
                }

            </tbody>
        </table>
        }
    </section>
    @if(!loading() && total() > 0){
    <div class="pager">
        <button (click)="goPrev()" [disabled]="page() <= 1"  i18n="@@previous" >« Anterior</button>
        <span i18n="@@page" >Página {{ page() }} de {{ lastPage() }} ({{ total() }} resultados)</span>
        <button (click)="goNext()" [disabled]="page() >= lastPage()" i18n="@@next" >Siguiente »</button>
    </div>
    }

</main>